(function(n,t){"use strict";typeof define=="function"&&define.amd?define(["angular"],t):typeof exports=="object"?module.exports=t(require("angular")):t(n.angular)})(this,function(n){"use strict";return n.module("gridster",[]).constant("gridsterConfig",{columns:6,pushing:!0,floating:!0,swapping:!1,width:"auto",colWidth:"auto",rowHeight:"match",margins:[10,10],outerMargin:!0,isMobile:!1,mobileBreakPoint:600,mobileModeEnabled:!0,minColumns:1,minRows:1,maxRows:100,defaultSizeX:2,defaultSizeY:1,minSizeX:1,maxSizeX:null,minSizeY:1,maxSizeY:null,saveGridItemCalculatedHeightInMobile:!1,resizable:{enabled:!0,handles:["s","e","n","w","se","ne","sw","nw"]},draggable:{enabled:!0,scrollSensitivity:20,scrollSpeed:15}}).controller("GridsterCtrl",["gridsterConfig","$timeout",function(t,i){var r=this,u;n.extend(this,t);this.resizable=n.extend({},t.resizable||{});this.draggable=n.extend({},t.draggable||{});u=!1;this.layoutChanged=function(){u||(u=!0,i(function(){u=!1;r.loaded&&r.floatItemsUp();r.updateHeight(r.movingItem?r.movingItem.sizeY:0)},30))};this.grid=[];this.destroy=function(){this.grid&&(this.grid=[]);this.$element=null};this.setOptions=function(t){if(t)if(t=n.extend({},t),t.draggable&&(n.extend(this.draggable,t.draggable),delete t.draggable),t.resizable&&(n.extend(this.resizable,t.resizable),delete t.resizable),n.extend(this,t),this.margins&&this.margins.length===2)for(var i=0,r=this.margins.length;i<r;++i)this.margins[i]=parseInt(this.margins[i],10),isNaN(this.margins[i])&&(this.margins[i]=0);else this.margins=[0,0]};this.canItemOccupy=function(n,t,i){return t>-1&&i>-1&&n.sizeX+i<=this.columns&&n.sizeY+t<=this.maxRows};this.autoSetItemPosition=function(n){for(var i,r,t=0;t<this.maxRows;++t)for(i=0;i<this.columns;++i)if(r=this.getItems(t,i,n.sizeX,n.sizeY,n),r.length===0&&this.canItemOccupy(n,t,i)){this.putItem(n,t,i);return}throw new Error("Unable to place item!");};this.getItems=function(n,t,i,r,u){var s=[],e,o,f;for(i&&r||(i=r=1),!u||u instanceof Array||(u=[u]),e=0;e<r;++e)for(o=0;o<i;++o)f=this.getItem(n+e,t+o,u),f&&(!u||u.indexOf(f)===-1)&&s.indexOf(f)===-1&&s.push(f);return s};this.getBoundingBox=function(n){var u,o,t;if(n.length===0)return null;if(n.length===1)return{row:n[0].row,col:n[0].col,sizeY:n[0].sizeY,sizeX:n[0].sizeX};var f=0,e=0,i=9999,r=9999;for(u=0,o=n.length;u<o;++u)t=n[u],i=Math.min(t.row,i),r=Math.min(t.col,r),f=Math.max(t.row+t.sizeY,f),e=Math.max(t.col+t.sizeX,e);return{row:i,col:r,sizeY:f-i,sizeX:e-r}};this.removeItem=function(n){for(var i,r,t=0,u=this.grid.length;t<u;++t)if((i=this.grid[t],i)&&(r=i.indexOf(n),r!==-1)){i[r]=null;break}this.layoutChanged()};this.getItem=function(n,t,i){var f,e,u,o,r;for(!i||i instanceof Array||(i=[i]),f=1;n>-1;){for(e=1,u=t;u>-1;){if(o=this.grid[n],o&&(r=o[u],r&&(!i||i.indexOf(r)===-1)&&r.sizeX>=e&&r.sizeY>=f))return r;++e;--u}--n;++f}return null};this.putItems=function(n){for(var t=0,i=n.length;t<i;++t)this.putItem(n[t])};this.putItem=function(n,t,i,r){var f,e,u;if((typeof t=="undefined"||t===null)&&(t=n.row,i=n.col,typeof t=="undefined"||t===null)){this.autoSetItemPosition(n);return}if(this.canItemOccupy(n,t,i)||(i=Math.min(this.columns-n.sizeX,Math.max(0,i)),t=Math.min(this.maxRows-n.sizeY,Math.max(0,t))),n.oldRow!==null&&typeof n.oldRow!="undefined"){if(f=n.oldRow===t&&n.oldColumn===i,e=this.grid[t]&&this.grid[t][i]===n,f&&e){n.row=t;n.col=i;return}u=this.grid[n.oldRow];u&&u[n.oldColumn]===n&&delete u[n.oldColumn]}n.oldRow=n.row=t;n.oldColumn=n.col=i;this.moveOverlappingItems(n,r);this.grid[t]||(this.grid[t]=[]);this.grid[t][i]=n;this.movingItem===n&&this.floatItemUp(n);this.layoutChanged()};this.swapItems=function(n,t){this.grid[n.row][n.col]=t;this.grid[t.row][t.col]=n;var i=n.row,r=n.col;n.row=t.row;n.col=t.col;t.row=i;t.col=r};this.moveOverlappingItems=function(n,t){t?t.indexOf(n)===-1&&(t=t.slice(0),t.push(n)):t=[n];var i=this.getItems(n.row,n.col,n.sizeX,n.sizeY,t);this.moveItemsDown(i,n.row+n.sizeY,t)};this.moveItemsDown=function(n,t,i){var f,r,u,e,o,s;if(n&&n.length!==0){for(n.sort(function(n,t){return n.row-t.row}),i=i?i.slice(0):[],f={},u=0,e=n.length;u<e;++u)r=n[u],o=f[r.col],(typeof o=="undefined"||r.row<o)&&(f[r.col]=r.row);for(u=0,e=n.length;u<e;++u)r=n[u],s=t-f[r.col],this.moveItemDown(r,r.row+s,i),i.push(r)}};this.moveItemDown=function(n,t,i){if(!(n.row>=t)){while(n.row<t)++n.row,this.moveOverlappingItems(n,i);this.putItem(n,n.row,n.col,i)}};this.floatItemsUp=function(){var n,u,t,i,f,r;if(this.floating!==!1)for(n=0,u=this.grid.length;n<u;++n)if(t=this.grid[n],t)for(i=0,f=t.length;i<f;++i)r=t[i],r&&this.floatItemUp(r)};this.floatItemUp=function(n){var f;if(this.floating!==!1){for(var r=n.col,e=n.sizeY,o=n.sizeX,i=null,u=null,t=n.row-1;t>-1;){if(f=this.getItems(t,r,o,e,n),f.length!==0)break;i=t;u=r;--t}i!==null&&this.putItem(n,i,u)}};this.updateHeight=function(n){var t=this.minRows,i,r,u,f;for(n=n||0,i=this.grid.length;i>=0;--i)if(r=this.grid[i],r)for(u=0,f=r.length;u<f;++u)r[u]&&(t=Math.max(t,i+n+r[u].sizeY));this.gridHeight=this.maxRows-t>0?Math.min(this.maxRows,t):Math.max(this.maxRows,t)};this.pixelsToRows=function(n,t){return(this.outerMargin||(n+=this.margins[0]/2),t===!0)?Math.ceil(n/this.curRowHeight):t===!1?Math.floor(n/this.curRowHeight):Math.round(n/this.curRowHeight)};this.pixelsToColumns=function(n,t){return(this.outerMargin||(n+=this.margins[1]/2),t===!0)?Math.ceil(n/this.curColWidth):t===!1?Math.floor(n/this.curColWidth):Math.round(n/this.curColWidth)}}]).directive("gridsterPreview",function(){return{replace:!0,scope:!0,require:"^gridster",template:'<div ng-style="previewStyle()" class="gridster-item gridster-preview-holder"><\/div>',link:function(n,t,i,r){n.previewStyle=function(){return r.movingItem?{display:"block",height:r.movingItem.sizeY*r.curRowHeight-r.margins[0]+"px",width:r.movingItem.sizeX*r.curColWidth-r.margins[1]+"px",top:r.movingItem.row*r.curRowHeight+(r.outerMargin?r.margins[0]:0)+"px",left:r.movingItem.col*r.curColWidth+(r.outerMargin?r.margins[1]:0)+"px"}:{display:"none"}}}}}).directive("gridster",["$timeout","$window","$rootScope","gridsterDebounce",function(t,i,r,u){return{scope:!0,restrict:"EAC",controller:"GridsterCtrl",controllerAs:"gridster",compile:function(f){return f.prepend('<div ng-if="gridster.movingItem" gridster-preview><\/div>'),function(f,e,o,s){function l(n){var r,f,t,i,o,u;if(s.setOptions(n),c(e[0])){for(s.curWidth=s.width==="auto"?e[0].offsetWidth||parseInt(e.css("width"),10):s.width,s.curColWidth=s.colWidth==="auto"?(s.curWidth+(s.outerMargin?-s.margins[1]:s.margins[1]))/s.columns:s.colWidth,s.curRowHeight=s.rowHeight,typeof s.rowHeight=="string"&&(s.rowHeight==="match"?s.curRowHeight=Math.round(s.curColWidth):s.rowHeight.indexOf("*")!==-1?s.curRowHeight=Math.round(s.curColWidth*s.rowHeight.replace("*","").replace(" ","")):s.rowHeight.indexOf("/")!==-1&&(s.curRowHeight=Math.round(s.curColWidth/s.rowHeight.replace("/","").replace(" ","")))),s.isMobile=s.mobileModeEnabled&&s.curWidth<=s.mobileBreakPoint,r=0,f=s.grid.length;r<f;++r)if(t=s.grid[r],t)for(i=0,o=t.length;i<o;++i)t[i]&&(u=t[i],u.setElementPosition(),u.setElementSizeY(),u.setElementSizeX());y()}}function y(){e.css("height",s.gridHeight*s.curRowHeight+(s.outerMargin?s.margins[0]:-s.margins[0])+"px")}var c,a,v;s.loaded=!1;s.$element=e;f.gridster=s;e.addClass("gridster");c=function(n){return n.style.visibility!=="hidden"&&n.style.display!=="none"};a=o.gridster;a?f.$parent.$watch(a,function(n){l(n)},!0):l({});f.$watch(function(){return s.loaded},function(){s.loaded?e.addClass("gridster-loaded"):e.removeClass("gridster-loaded")});f.$watch(function(){return s.isMobile},function(){s.isMobile?e.addClass("gridster-mobile").removeClass("gridster-desktop"):e.removeClass("gridster-mobile").addClass("gridster-desktop");r.$broadcast("gridster-mobile-changed",s)});f.$watch(function(){return s.draggable},function(){r.$broadcast("gridster-draggable-changed",s)},!0);f.$watch(function(){return s.resizable},function(){r.$broadcast("gridster-resizable-changed",s)},!0);f.$watch(function(){return s.gridHeight},y);f.$watch(function(){return s.movingItem},function(){s.updateHeight(s.movingItem?s.movingItem.sizeY:0)});var p=e[0].offsetWidth||parseInt(e.css("width"),10),w=function(){var n=e[0].offsetWidth||parseInt(e.css("width"),10);n&&n!==p&&!s.movingItem&&(p=n,s.loaded&&e.removeClass("gridster-loaded"),l(),s.loaded&&e.addClass("gridster-loaded"),r.$broadcast("gridster-resized",[n,e[0].offsetHeight],s))},h=u(function(){w();t(function(){f.$apply()})},100);f.$watch(function(){return c(e[0])},h);typeof addResizeListener=="function"?window.addResizeListener(e[0],h):f.$watch(function(){return e[0].offsetWidth||parseInt(e.css("width"),10)},w);v=n.element(i);v.on("resize",h);f.$on("$destroy",function(){s.destroy();v.off("resize",h);typeof removeResizeListener=="function"&&window.removeResizeListener(e[0],h)});t(function(){f.$watch("gridster.floating",function(){s.floatItemsUp()});s.loaded=!0},100)}}}}]).controller("GridsterItemCtrl",function(){this.$element=null;this.gridster=null;this.row=null;this.col=null;this.sizeX=null;this.sizeY=null;this.minSizeX=0;this.minSizeY=0;this.maxSizeX=null;this.maxSizeY=null;this.init=function(n,t){this.$element=n;this.gridster=t;this.sizeX=t.defaultSizeX;this.sizeY=t.defaultSizeY};this.destroy=function(){this.gridster=null;this.$element=null};this.toJSON=function(){return{row:this.row,col:this.col,sizeY:this.sizeY,sizeX:this.sizeX}};this.isMoving=function(){return this.gridster.movingItem===this};this.setPosition=function(n,t){this.gridster.putItem(this,n,t);this.isMoving()||this.setElementPosition()};this.setSize=function(n,t,i){var e,r,u,f,o;if(n=n.toUpperCase(),e="size"+n,r="Size"+n,t!=="")return t=parseInt(t,10),(isNaN(t)||t===0)&&(t=this.gridster["default"+r]),u=n==="X"?this.gridster.columns:this.gridster.maxRows,this["max"+r]&&(u=Math.min(this["max"+r],u)),this.gridster["max"+r]&&(u=Math.min(this.gridster["max"+r],u)),n==="X"&&this.cols?u-=this.cols:n==="Y"&&this.rows&&(u-=this.rows),f=0,this["min"+r]&&(f=Math.max(this["min"+r],f)),this.gridster["min"+r]&&(f=Math.max(this.gridster["min"+r],f)),t=Math.max(Math.min(t,u),f),o=this[e]!==t||this["old"+r]&&this["old"+r]!==t,this["old"+r]=this[e]=t,this.isMoving()||this["setElement"+r](),!i&&o&&(this.gridster.moveOverlappingItems(this),this.gridster.layoutChanged()),o};this.setSizeY=function(n,t){return this.setSize("Y",n,t)};this.setSizeX=function(n,t){return this.setSize("X",n,t)};this.setElementPosition=function(){this.gridster.isMobile?this.$element.css({marginLeft:this.gridster.margins[0]+"px",marginRight:this.gridster.margins[0]+"px",marginTop:this.gridster.margins[1]+"px",marginBottom:this.gridster.margins[1]+"px",top:"",left:""}):this.$element.css({margin:0,top:this.row*this.gridster.curRowHeight+(this.gridster.outerMargin?this.gridster.margins[0]:0)+"px",left:this.col*this.gridster.curColWidth+(this.gridster.outerMargin?this.gridster.margins[1]:0)+"px"})};this.setElementSizeY=function(){this.gridster.isMobile&&!this.gridster.saveGridItemCalculatedHeightInMobile?this.$element.css("height",""):this.$element.css("height",this.sizeY*this.gridster.curRowHeight-this.gridster.margins[0]+"px")};this.setElementSizeX=function(){this.gridster.isMobile?this.$element.css("width",""):this.$element.css("width",this.sizeX*this.gridster.curColWidth-this.gridster.margins[1]+"px")};this.getElementSizeX=function(){return this.sizeX*this.gridster.curColWidth-this.gridster.margins[1]};this.getElementSizeY=function(){return this.sizeY*this.gridster.curRowHeight-this.gridster.margins[0]}}).factory("GridsterTouch",[function(){return function(n,t,i,r){var f={},o=function(n){if(Object.keys)return Object.keys(n).length;var t=0;for(var i in n)++t;return t},l=function(n){for(var r=0,i=0,u=navigator.userAgent.match(/\bMSIE\b/),t=n;t!=null;t=t.offsetParent)u&&(!document.documentMode||document.documentMode<8)&&t.currentStyle.position==="relative"&&t.offsetParent&&t.offsetParent.currentStyle.position==="relative"&&t.offsetLeft===t.offsetParent.offsetLeft?i+=t.offsetTop:(r+=t.offsetLeft,i+=t.offsetTop);return{x:r,y:i}},s=l(n),u=function(h){var v,k,b,c,a,d,g,y,p,w;if(h.type!=="mousemove"||o(f)!==0){for(v=!0,k=h.changedTouches?h.changedTouches:[h],b=0;b<k.length;++b){if(c=k[b],a=typeof c.identifier!="undefined"?c.identifier:typeof c.pointerId!="undefined"?c.pointerId:1,typeof c.pageX=="undefined")if(c.pageX=c.offsetX+s.x,c.pageY=c.offsetY+s.y,c.srcElement.offsetParent===n&&document.documentMode&&document.documentMode===8&&c.type==="mousedown")c.pageX+=c.srcElement.offsetLeft,c.pageY+=c.srcElement.offsetTop;else if(c.srcElement!==n&&!document.documentMode||document.documentMode<8){for(d=-2,g=-2,y=c.srcElement;y!==null;y=y.parentNode)d+=y.scrollLeft?y.scrollLeft:0,g+=y.scrollTop?y.scrollTop:0;c.pageX=c.clientX+d;c.pageY=c.clientY+g}p=c.pageX;w=c.pageY;h.type.match(/(start|down)$/i)?(s=l(n),f[a]&&(r&&r({target:h.target,which:h.which,pointerId:a,pageX:p,pageY:w}),delete f[a]),t&&v&&(v=t({target:h.target,which:h.which,pointerId:a,pageX:p,pageY:w})),f[a]={x:p,y:w},n.msSetPointerCapture&&v?n.msSetPointerCapture(a):h.type==="mousedown"&&o(f)===1&&(e?n.setCapture(!0):(document.addEventListener("mousemove",u,!1),document.addEventListener("mouseup",u,!1)))):h.type.match(/move$/i)?!f[a]||f[a].x===p&&f[a].y===w||(i&&v&&(v=i({target:h.target,which:h.which,pointerId:a,pageX:p,pageY:w})),f[a].x=p,f[a].y=w):f[a]&&h.type.match(/(up|end|cancel)$/i)&&(r&&v&&(v=r({target:h.target,which:h.which,pointerId:a,pageX:p,pageY:w})),delete f[a],n.msReleasePointerCapture?n.msReleasePointerCapture(a):h.type==="mouseup"&&o(f)===0&&(e?n.releaseCapture():(document.removeEventListener("mousemove",u,!1),document.removeEventListener("mouseup",u,!1))))}v&&(h.preventDefault&&h.preventDefault(),h.preventManipulation&&h.preventManipulation(),h.preventMouseEvent&&h.preventMouseEvent())}},e=!1,h,c;return this.enable=function(){window.navigator.msPointerEnabled?(n.addEventListener("MSPointerDown",u,!1),n.addEventListener("MSPointerMove",u,!1),n.addEventListener("MSPointerUp",u,!1),n.addEventListener("MSPointerCancel",u,!1),typeof n.style.msContentZooming!="undefined"&&(h=n.style.msContentZooming,n.style.msContentZooming="none"),typeof n.style.msTouchAction!="undefined"&&(c=n.style.msTouchAction,n.style.msTouchAction="none")):n.addEventListener?(n.addEventListener("touchstart",u,!1),n.addEventListener("touchmove",u,!1),n.addEventListener("touchend",u,!1),n.addEventListener("touchcancel",u,!1),n.addEventListener("mousedown",u,!1),n.setCapture&&!window.navigator.userAgent.match(/\bGecko\b/)&&(e=!0,n.addEventListener("mousemove",u,!1),n.addEventListener("mouseup",u,!1))):n.attachEvent&&n.setCapture&&(e=!0,n.attachEvent("onmousedown",function(){return u(window.event),window.event.returnValue=!1,!1}),n.attachEvent("onmousemove",function(){return u(window.event),window.event.returnValue=!1,!1}),n.attachEvent("onmouseup",function(){return u(window.event),window.event.returnValue=!1,!1}))},this.disable=function(){window.navigator.msPointerEnabled?(n.removeEventListener("MSPointerDown",u,!1),n.removeEventListener("MSPointerMove",u,!1),n.removeEventListener("MSPointerUp",u,!1),n.removeEventListener("MSPointerCancel",u,!1),h&&(n.style.msContentZooming=h),c&&(n.style.msTouchAction=c)):n.removeEventListener?(n.removeEventListener("touchstart",u,!1),n.removeEventListener("touchmove",u,!1),n.removeEventListener("touchend",u,!1),n.removeEventListener("touchcancel",u,!1),n.removeEventListener("mousedown",u,!1),n.setCapture&&!window.navigator.userAgent.match(/\bGecko\b/)&&(e=!0,n.removeEventListener("mousemove",u,!1),n.removeEventListener("mouseup",u,!1))):n.detachEvent&&n.setCapture&&(e=!0,n.detachEvent("onmousedown"),n.detachEvent("onmousemove"),n.detachEvent("onmouseup"))},this}}]).factory("GridsterDraggable",["$document","$window","GridsterTouch",function(t,i,r){function u(u,f,e,o,s){function et(t){var i,h,r,f,p,a,v,y,s;if(ft.indexOf(t.target.nodeName.toLowerCase())!==-1||(i=n.element(t.target),i.hasClass("gridster-item-resizable-handler"))||i.attr("onclick")||i.attr("ng-click")||i.closest&&i.closest(".gridster-no-drag").length)return!1;if(e.draggable&&e.draggable.handle){h=n.element(u[0].querySelectorAll(e.draggable.handle));r=!1;n:for(f=0,p=h.length;f<p;++f){if(a=h[f],a===t.target){r=!0;break}for(v=t.target,y=0;y<20;++y){if(s=v.parentNode,s===u[0])break;if(s===a){r=!0;break n}v=s}}if(!r)return!1}switch(t.which){case 2:case 3:return}return g=t.pageX,nt=t.pageY,c=parseInt(u.css("left"),10),l=parseInt(u.css("top"),10),w=u[0].offsetWidth,b=u[0].offsetHeight,rt=o.col,ut=o.row,ht(t),!0}function ot(n){var o,s,t,i,r,f;return!u.hasClass("gridster-item-moving")||u.hasClass("gridster-item-resizing")?!1:(o=e.curWidth-1,s=e.curRowHeight*e.maxRows-1,k=n.pageX,d=n.pageY,t=k-g+v,i=d-nt+y,v=y=0,g=k,nt=d,r=t,f=i,c+r<it?(t=it-c,v=r-t):c+w+r>o&&(t=o-c-w,v=r-t),l+f<tt?(i=tt-l,y=f-i):l+b+f>s&&(i=s-l-b,y=f-i),c+=t,l+=i,u.css({top:l+"px",left:c+"px"}),ct(n),!0)}function st(n){return!u.hasClass("gridster-item-moving")||u.hasClass("gridster-item-resizing")?!1:(v=y=0,lt(n),!0)}function ht(n){u.addClass("gridster-item-moving");e.movingItem=o;e.updateHeight(o.sizeY);f.$apply(function(){e.draggable&&e.draggable.start&&e.draggable.start(n,u,s)})}function ct(n){var k=o.row,d=o.col,g=e.draggable&&e.draggable.drag,p=e.draggable.scrollSensitivity,w=e.draggable.scrollSpeed,v=Math.min(e.pixelsToRows(l),e.maxRows-1),y=Math.min(e.pixelsToColumns(c),e.columns-1),a=e.getItems(v,y,o.sizeX,o.sizeY,o),nt=a.length!==0,b,ut,r,ft;if(e.swapping===!0&&nt){var t=e.getBoundingBox(a),et=t.sizeX===o.sizeX&&t.sizeY===o.sizeY,ot=t.row===k,st=t.col===d,ht=t.row===v&&t.col===y,tt=ot||st;if(et&&a.length===1){if(ht)e.swapItems(o,a[0]);else if(tt)return}else if(t.sizeX<=o.sizeX&&t.sizeY<=o.sizeY&&tt){var ct=o.row<=v?o.row:v+o.sizeY,lt=o.col<=y?o.col:y+o.sizeX,it=ct-t.row,rt=lt-t.col;for(b=0,ut=a.length;b<ut;++b)r=a[b],ft=e.getItems(r.row+it,r.col+rt,r.sizeX,r.sizeY,o),ft.length===0&&e.putItem(r,r.row+it,r.col+rt)}}e.pushing===!1&&nt||(o.row=v,o.col=y);n.pageY-h.body.scrollTop<p?h.body.scrollTop=h.body.scrollTop-w:i.innerHeight-(n.pageY-h.body.scrollTop)<p&&(h.body.scrollTop=h.body.scrollTop+w);n.pageX-h.body.scrollLeft<p?h.body.scrollLeft=h.body.scrollLeft-w:i.innerWidth-(n.pageX-h.body.scrollLeft)<p&&(h.body.scrollLeft=h.body.scrollLeft+w);(g||k!==o.row||d!==o.col)&&f.$apply(function(){g&&e.draggable.drag(n,u,s)})}function lt(n){u.removeClass("gridster-item-moving");var t=Math.min(e.pixelsToRows(l),e.maxRows-1),i=Math.min(e.pixelsToColumns(c),e.columns-1);(e.pushing!==!1||e.getItems(t,i,o.sizeX,o.sizeY,o).length===0)&&(o.row=t,o.col=i);e.movingItem=null;o.setPosition(o.row,o.col);f.$apply(function(){e.draggable&&e.draggable.stop&&e.draggable.stop(n,u,s)})}var c,l,w,b,k=0,d=0,g=0,nt=0,v=0,y=0,tt=0,it=0,h=t[0],rt,ut,ft=["select","option","input","textarea","button"],p=null,a=null;this.enable=function(){if(p!==!0){if(p=!0,a){a.enable();return}a=new r(u[0],et,ot,st);a.enable()}};this.disable=function(){p!==!1&&(p=!1,a&&a.disable())};this.toggle=function(n){n?this.enable():this.disable()};this.destroy=function(){this.disable()}}return u}]).factory("GridsterResizable",["GridsterTouch",function(t){function i(i,r,u,f,e){function a(o){function st(n){switch(n.which){case 2:case 3:return}return k=u.draggable.enabled,k&&(u.draggable.enabled=!1,r.$broadcast("gridster-draggable-changed",u)),tt=n.pageX,it=n.pageY,c=parseInt(i.css("left"),10),l=parseInt(i.css("top"),10),s=i[0].offsetWidth,h=i[0].offsetHeight,et=f.sizeX,ot=f.sizeY,ht(n),!0}function ht(n){i.addClass("gridster-item-moving");i.addClass("gridster-item-resizing");u.movingItem=f;f.setElementSizeX();f.setElementSizeY();f.setElementPosition();u.updateHeight(1);r.$apply(function(){u.resizable&&u.resizable.start&&u.resizable.start(n,i,e)})}function ct(n){var o=u.curWidth-1,t,r,f,e;return g=n.pageX,nt=n.pageY,t=g-tt+a,r=nt-it+v,a=v=0,tt=g,it=nt,f=r,e=t,p.indexOf("n")>=0&&(h-f<w()?(r=h-w(),v=f-r):l+f<rt&&(r=rt-l,v=f-r),l+=r,h-=r),p.indexOf("s")>=0&&(h+f<w()?(r=w()-h,v=f-r):l+h+f>ut&&(r=ut-l-h,v=f-r),h+=r),p.indexOf("w")>=0&&(s-e<b()?(t=s-b(),a=e-t):c+e<ft&&(t=ft-c,a=e-t),c+=t,s-=t),p.indexOf("e")>=0&&(s+e<b()?(t=b()-s,a=e-t):c+s+e>o&&(t=o-c-s,a=e-t),s+=t),i.css({top:l+"px",left:c+"px",width:s+"px",height:h+"px"}),at(n),!0}function lt(n){return u.draggable.enabled!==k&&(u.draggable.enabled=k,r.$broadcast("gridster-draggable-changed",u)),a=v=0,vt(n),!0}function at(n){var k=f.row,d=f.col,g=f.sizeX,nt=f.sizeY,p=u.resizable&&u.resizable.resize,a=f.col,t,v,y,w,b;["w","nw","sw"].indexOf(o)!==-1&&(a=u.pixelsToColumns(c,!1));t=f.row;["n","ne","nw"].indexOf(o)!==-1&&(t=u.pixelsToRows(l,!1));v=f.sizeX;["n","s"].indexOf(o)===-1&&(v=u.pixelsToColumns(s,!0));y=f.sizeY;["e","w"].indexOf(o)===-1&&(y=u.pixelsToRows(h,!0));w=t>-1&&a>-1&&v+a<=u.columns&&y+t<=u.maxRows;w&&(u.pushing!==!1||u.getItems(t,a,v,y,f).length===0)&&(f.row=t,f.col=a,f.sizeX=v,f.sizeY=y);b=f.row!==k||f.col!==d||f.sizeX!==g||f.sizeY!==nt;(p||b)&&r.$apply(function(){p&&u.resizable.resize(n,i,e)})}function vt(n){i.removeClass("gridster-item-moving");i.removeClass("gridster-item-resizing");u.movingItem=null;f.setPosition(f.row,f.col);f.setSizeY(f.sizeY);f.setSizeX(f.sizeX);r.$apply(function(){u.resizable&&u.resizable.stop&&u.resizable.stop(n,i,e)})}var p=o,c,l,s,h,g=0,nt=0,tt=0,it=0,a=0,v=0,rt=0,ut=9999,ft=0,w=function(){return(f.minSizeY?f.minSizeY:1)*u.curRowHeight-u.margins[0]},b=function(){return(f.minSizeX?f.minSizeX:1)*u.curColWidth-u.margins[1]},et,ot,k,y=null,d;this.enable=function(){y||(y=n.element('<div class="gridster-item-resizable-handler handle-'+p+'"><\/div>'),i.append(y));d=new t(y[0],st,ct,lt);d.enable()};this.disable=function(){y&&(y.remove(),y=null);d.disable();d=undefined};this.destroy=function(){this.disable()}}var o=[],h=u.resizable.handles,s,c,l;for(typeof h=="string"&&(h=u.resizable.handles.split(",")),s=!1,c=0,l=h.length;c<l;c++)o.push(new a(h[c]));this.enable=function(){if(!s){for(var n=0,t=o.length;n<t;n++)o[n].enable();s=!0}};this.disable=function(){if(s){for(var n=0,t=o.length;n<t;n++)o[n].disable();s=!1}};this.toggle=function(n){n?this.enable():this.disable()};this.destroy=function(){for(var n=0,t=o.length;n<t;n++)o[n].destroy()}}return i}]).factory("gridsterDebounce",function(){return function(n,t,i){var r;return function(){var u=this,f=arguments,e=function(){r=null;i||n.apply(u,f)},o=i&&!r;clearTimeout(r);r=setTimeout(e,t);o&&n.apply(u,f)}}}).directive("gridsterItem",["$parse","GridsterDraggable","GridsterResizable","gridsterDebounce",function(n,t,i,r){return{scope:!0,restrict:"EA",controller:"GridsterItemCtrl",controllerAs:"gridsterItem",require:["^gridster","gridsterItem"],link:function(u,f,e,o){function ut(){s.setPosition(s.row,s.col);h.row&&h.row.assign&&h.row.assign(u,s.row);h.col&&h.col.assign&&h.col.assign(u,s.col)}function ft(){var t=s.setSizeX(s.sizeX,!0),n;t&&h.sizeX&&h.sizeX.assign&&h.sizeX.assign(u,s.sizeX);n=s.setSizeY(s.sizeY,!0);n&&h.sizeY&&h.sizeY.assign&&h.sizeY.assign(u,s.sizeY);(t||n)&&(s.gridster.moveOverlappingItems(s),c.layoutChanged(),u.$broadcast("gridster-item-resized",s))}function et(){var i=document.createElement("div"),n={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(var t in n)if(i.style[t]!==undefined)return n[t]}var a=e.gridsterItem,l,c=o[0],s=o[1],v,y,d,g,w,it;u.gridster=c;a?(v=n(a),l=v(u)||{},!l&&v.assign&&(l={row:s.row,col:s.col,sizeX:s.sizeX,sizeY:s.sizeY,minSizeX:0,minSizeY:0,maxSizeX:null,maxSizeY:null},v.assign(u,l))):l=e;s.init(f,c);f.addClass("gridster-item");var b=["minSizeX","maxSizeX","minSizeY","maxSizeY","sizeX","sizeY","row","col"],h={},k=[],rt=function(t){var i,r;if(typeof l[t]=="string")i=l[t];else if(typeof l[t.toLowerCase()]=="string")i=l[t.toLowerCase()];else if(a)i=a+"."+t;else return;k.push('"'+t+'":'+i);h[t]=n(i);r=h[t](u);typeof r=="number"&&(s[t]=r)};for(y=0,d=b.length;y<d;++y)rt(b[y]);g="{"+k.join(",")+"}";u.$watchCollection(g,function(n,t){var r,i,u;for(r in n)(i=n[r],u=t[r],u!==i)&&(i=parseInt(i,10),isNaN(i)||(s[r]=i))});u.$watch(function(){return s.row+","+s.col},ut);u.$watch(function(){return s.sizeY+","+s.sizeX+","+s.minSizeX+","+s.maxSizeX+","+s.minSizeY+","+s.maxSizeY},ft);var nt=new t(f,u,c,s,l),tt=new i(f,u,c,s,l),p=function(){tt.toggle(!c.isMobile&&c.resizable&&c.resizable.enabled)};p();w=function(){nt.toggle(!c.isMobile&&c.draggable&&c.draggable.enabled)};w();u.$on("gridster-draggable-changed",w);u.$on("gridster-resizable-changed",p);u.$on("gridster-resized",p);u.$on("gridster-mobile-changed",function(){p();w()});it=r(function(){u.$apply(function(){u.$broadcast("gridster-item-transition-end",s)})},50);f.on(et(),it);return u.$broadcast("gridster-item-initialized",s),u.$on("$destroy",function(){try{tt.destroy();nt.destroy()}catch(n){}try{c.removeItem(s)}catch(n){}try{s.destroy()}catch(n){}})}}}]).directive("gridsterNoDrag",function(){return{restrict:"A",link:function(n,t){t.addClass("gridster-no-drag")}}})});
//# sourceMappingURL=angular-gridster.min.js.map
